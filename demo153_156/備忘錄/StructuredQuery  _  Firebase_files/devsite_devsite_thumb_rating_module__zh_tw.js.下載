(function(_ds){var window=this;var oW=function(a){var b=a.position,c=a.Rn;a=a.Sn;b='<div class="devsite-thumb-rating" role="form" aria-labelledby="devsite-thumb-label-'+_ds.R(b)+'" tabindex="0"><div class="devsite-thumb-label" id="devsite-thumb-label-'+_ds.R(b)+'">';b=b+"\u9019\u5c0d\u4f60\u6709\u5e6b\u52a9\u55ce\uff1f"+('</div><div class="devsite-thumbs">'+nW(a.label,a.Uf,a.type)+nW(c.label,c.Uf,c.type)+"</div></div>");return(0,_ds.P)(b)},nW=function(a,b,c){let d;"thumb-down-filled"==c?d=(0,_ds.P)('<path d="M3,17h6.31l-0.95,4.57l-0.03,0.32c0,0.41,0.17,0.79,0.44,1.06L9.83,24c0,0,7.09-6.85,7.17-7V4H6C5.17,4,4.46,4.5,4.16,5.22 l-3.02,7.05C1.05,12.5,1,12.74,1,13v2C1,16.1,1.9,17,3,17z"></path><path d="M19,17h4V4h-4V17L19,17z"></path>'):
"thumb-down-outline"==c?d=(0,_ds.P)('<path d="M3,17h6.31l-0.95,4.57l-0.03,0.32c0,0.41,0.17,0.79,0.44,1.06L9.83,24c0,0,7.09-6.85,7.17-7h5V4H6 C5.17,4,4.46,4.5,4.16,5.22l-3.02,7.05C1.05,12.5,1,12.74,1,13v2C1,16.1,1.9,17,3,17z M17,6h3v9h-3V6z M3,13l3-7h9v10l-4.34,4.34 L12,15H3V13z"></path>'):"thumb-up-filled"==c?d=(0,_ds.P)('<path d="M21,7h-6.31l0.95-4.57l0.03-0.32c0-0.41-0.17-0.79-0.44-1.06L14.17,0c0,0-7.09,6.85-7.17,7v13h11c0.83,0,1.54-0.5,1.84-1.22 l3.02-7.05C22.95,11.5,23,11.26,23,11V9C23,7.9,22.1,7,21,7z"></path><path d="M5,7H1v13h4V7L5,7z"></path>'):
"thumb-up-outline"==c?d=(0,_ds.P)('<path d="M21,7h-6.31l0.95-4.57l0.03-0.32c0-0.41-0.17-0.79-0.44-1.06L14.17,0c0,0-7.09,6.85-7.17,7H2v13h16 c0.83,0,1.54-0.5,1.84-1.22l3.02-7.05C22.95,11.5,23,11.26,23,11V9C23,7.9,22.1,7,21,7z M7,18H4V9h3V18z M21,11l-3,7H9V8l4.34-4.34 L12,9h9V11z"></path>'):d="";return(0,_ds.P)('<button class="devsite-thumb '+_ds.R(b)+'" data-title="'+_ds.R(a)+'" aria-label="'+_ds.R(a)+'"><svg class="devsite-thumb-icon" viewBox="0 0 24 24" aria-hidden="true">'+d+"</svg></button>")},
pW=function(a){var b=a.fd;a='<devsite-dialog class="devsite-thumb-rating-dialog" id="'+_ds.R(a.dg)+'"><div class="devsite-dialog-contents"><h3 class="no-link" tabindex="-1">';a+='\u63d0\u4ea4\u610f\u898b\u56de\u994b\u7684\u539f\u56e0\u70ba\u4f55\uff1f</h3><form class="devsite-thumb-rating-categories">';const c=b.length;for(let d=0;d<c;d++){const e=b[d];a+='<div class="devsite-thumb-rating-category"><input type="radio" name="'+_ds.R(e.type)+'" id="'+_ds.R(e.id)+'"><label for="'+_ds.R(e.id)+'">'+_ds.Q(e.label)+
"</label></div>"}return(0,_ds.P)(a+'</form></div><div class="devsite-dialog-buttons"><button type="submit" class="button button-primary devsite-thumb-rating-submit" disabled>\u63d0\u4ea4</button><button type="button" class="button devsite-dialog-close">\u53d6\u6d88</button></div></devsite-dialog>')},qW=function(a){var b=a.isSignedIn;a=a.fl;let c;c='<devsite-dialog class="devsite-thumb-rating-dialog" id="devsite-thumb-thank-you-dialog"><div class="devsite-dialog-contents"><h3 class="no-link">\u611f\u8b1d\u4f60\u63d0\u4f9b\u5bf6\u8cb4\u7684\u610f\u898b\u3002</h3>';
b?a&&(c+='<p class="create-profile-prompt">\u5229\u7528 Google \u958b\u767c\u4eba\u54e1\u8a2d\u5b9a\u6a94\u5132\u5b58\u5e38\u7528\u9801\u9762\u3002</p>'):c+='<p class="sign-in-prompt">\u4f60\u5fc5\u9808\u767b\u5165\u5e33\u6236\uff0c\u624d\u80fd\u900f\u904e Google \u958b\u767c\u4eba\u54e1\u8a2d\u5b9a\u6a94\u5132\u5b58\u7d93\u5e38\u9020\u8a2a\u7684\u7db2\u9801\u3002</p>';c+='</div><div class="devsite-dialog-buttons">';return(0,_ds.P)((b?a?c+'<button type="button" class="button button-primary create-profile">\u5efa\u7acb\u8a2d\u5b9a\u6a94':
c+'<button type="button" class="button button-primary devsite-dialog-close">\u95dc\u9589':c+'<button class="button button-primary sign-in-button">\u767b\u5165')+"</button></div></devsite-dialog>")},rW=function(){return(0,_ds.P)('<svg class="material-icons devsite-feedback-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17l-.59.59-.58.58V4h16v12zm-9-4h2v2h-2zm0-6h2v4h-2z"></path></svg>')},sW=function(a){var b=a.Hb;
a=a.ub;let c;c='<devsite-dialog class="devsite-thumb-rating-dialog" id="devsite-thumb-create-profile-dialog"><div class="create-profile-spinner"><devsite-spinner size="48"></devsite-spinner></div><div class="devsite-dialog-contents"><h3 class="no-link">\u5efa\u7acb Google \u958b\u767c\u4eba\u54e1\u8a2d\u5b9a\u6a94</h3>';a?(c+='<p>\u4f60\u662f\u5426\u5e0c\u671b\u6536\u5230 Google \u958b\u767c\u4eba\u54e1\u8a2d\u5b9a\u6a94\u767c\u9001\u7684\u96fb\u5b50\u90f5\u4ef6\uff1f\u4f60\u53ef\u4ee5\u85c9\u6b64\u53d6\u5f97\u958b\u767c\u4eba\u54e1\u6d3b\u52d5\u3001\u65b0\u529f\u80fd\u548c\u76f8\u95dc\u5167\u5bb9\u7684\u8cc7\u8a0a\u3002</p><input type="checkbox" id="devsite-thumb-create-profile-email-opt-in"><label for="devsite-thumb-create-profile-email-opt-in">\u7576\u7136\uff01</label><p class="account-note">',
b='\u5efa\u7acb\u958b\u767c\u4eba\u54e1\u8a2d\u5b9a\u6a94\u5373\u8868\u793a\u540c\u610f\u300a<a href="'+(_ds.R(_ds.T(b))+'">\u5167\u5bb9\u653f\u7b56</a>\u300b\u3002\u4f7f\u7528\u9019\u9805\u670d\u52d9\u6642\u5fc5\u9808\u9075\u5b88 Google \u7684\u300a<a href="https://policies.google.com/terms">\u670d\u52d9\u689d\u6b3e</a>\u300b\u53ca\u300a<a href="https://policies.google.com/privacy">\u96b1\u79c1\u6b0a\u653f\u7b56</a>\u300b\u3002Google \u958b\u767c\u4eba\u54e1\u8a2d\u5b9a\u6a94\u6703\u6cbf\u7528\u4f60\u7684 Google \u5e33\u6236\u540d\u7a31\u3002\u9019\u500b\u540d\u7a31\u53ef\u80fd\u6703\u4f34\u96a8\u4f60\u63d0\u4f9b\u7684\u5167\u5bb9\u986f\u793a\uff0c\u800c\u4f60\u96a8\u6642\u53ef\u4ee5\u8b8a\u66f4\u3002'),
c+=b):c+='<p class="not-eligible-prompt">\u9019\u500b\u5e33\u6236\u4e0d\u7b26\u5408\u5efa\u7acb\u958b\u767c\u4eba\u54e1\u8a2d\u5b9a\u6a94\u7684\u8cc7\u683c\u3002<a href="https://developers.google.com/profile/help#i%E2%80%99m_unable_to_create_a_profile_with_my_g_suite_account_why_is_that" target="_blank">\u77ad\u89e3\u8a73\u60c5</a>';c+='</p></div><div class="devsite-dialog-buttons">';return(0,_ds.P)((a?c+'<button class="button-primary create-profile">\u5efa\u7acb\u8a2d\u5b9a\u6a94':c+'<button class="button button-primary change-account-button">\u8b8a\u66f4\u5e33\u6236')+
'</button><button class="button devsite-dialog-close">\u95dc\u9589</button></div></devsite-dialog>')},tW=function(a){a='<devsite-dialog class="devsite-thumb-rating-dialog" id="devsite-thumb-error-dialog"><div class="devsite-dialog-contents"><h3 class="no-link">\u767c\u751f\u932f\u8aa4</h3><p>'+(_ds.Q(a.error)+'</p></div><div class="devsite-dialog-buttons"><button class="button devsite-dialog-close">');return(0,_ds.P)(a+"\u95dc\u9589</button></div></devsite-dialog>")};var vW=async function(a){var b=new _ds.yi(_ds.F().href);if(_ds.Ri(b.h,"thumb")){var c=b.h.get("thumb");if("up"===c||"down"===c)a.setAttribute("rating",c),await uW(a);b.h.remove("thumb");_ds.Yi(b.toString(),!0,!1)}else{var d=await a.ma();if(null!==d&&void 0!==d&&d.profileId){b=_ds.F().href;try{b=await _ds.Wn(b)}catch(f){}d=(null===d||void 0===d?void 0:d.profileId)||"";var e=new _ds.OA;try{c=await e.Qa({path:b,profileId:d}),"THUMBS_UP"===(null===c||void 0===c?void 0:c.ratingStatus)&&a.setAttribute("rating",
"up"),"THUMBS_DOWN"===(null===c||void 0===c?void 0:c.ratingStatus)&&a.setAttribute("rating","down")}catch(f){}}}},wW=function(a){let b="thumb-down-outline",c="thumb-up-outline";"down"===a.h?b="thumb-down-filled":"up"===a.h&&(c="thumb-up-filled");const d=a.getAttribute("position")||"";_ds.M(a,oW,{position:d,Rn:{Uf:"devsite-thumb-down",label:"\u6c92\u6709\u5e6b\u52a9",type:b},Sn:{Uf:"devsite-thumb-up",label:"\u6709\u5e6b\u52a9",type:c}})},yW=function(a){a.eventHandler.listen(a,"click",b=>{xW(a,b)})},
xW=async function(a,b){var c,d;b=b.target;if(null===b||void 0===b?0:b.classList.contains("devsite-thumb-up"))"up"===a.h?(a.removeAttribute("rating"),zW(a,"\u7db2\u9801\u8a55\u5206\u5df2\u79fb\u9664\u3002")):(a.setAttribute("rating","up"),0<a.G.length?(a.F=AW(a,a.G,"devsite-thumb-up-dialog"),a.F.setAttribute("open","")):(null===(c=a.mb)||void 0===c?void 0:c.setAttribute("rating-type","thumbsUp"),a.C=await BW(a),a.C.setAttribute("open","")),zW(a,"\u5df2\u5c07\u9801\u9762\u8a55\u50f9\u70ba\u6709\u5e6b\u52a9\u3002"),
await CW(a)),await uW(a);else if(null===b||void 0===b?0:b.classList.contains("devsite-thumb-down"))"down"===a.h?(a.removeAttribute("rating"),zW(a,"\u7db2\u9801\u8a55\u5206\u5df2\u79fb\u9664\u3002")):(a.setAttribute("rating","down"),0<a.H.length?(a.D=AW(a,a.H,"devsite-thumb-down-dialog"),a.D.setAttribute("open","")):(null===(d=a.mb)||void 0===d?void 0:d.setAttribute("rating-type","thumbsDown"),a.C=await BW(a),a.C.setAttribute("open","")),zW(a,"\u5df2\u5c07\u9801\u9762\u8a55\u50f9\u70ba\u6c92\u6709\u5e6b\u52a9\u3002"),
await CW(a)),await uW(a)},zW=function(a,b){a.dispatchEvent(new CustomEvent("devsite-show-custom-snackbar-msg",{detail:{msg:b,showClose:!1},bubbles:!0}))},AW=function(a,b,c){let d=document.body.querySelector(`#${c}`);if(d)return d;d=_ds.N(pW,{dg:c,fd:b});document.body.appendChild(d);a.eventHandler.listen(d,"change",()=>{var e,f,g,h;"down"===a.h?null===(f=null===(e=a.D)||void 0===e?void 0:e.querySelector(".devsite-thumb-rating-submit"))||void 0===f?void 0:f.removeAttribute("disabled"):"up"===a.h&&(null===
(h=null===(g=a.F)||void 0===g?void 0:g.querySelector(".devsite-thumb-rating-submit"))||void 0===h?void 0:h.removeAttribute("disabled"))});a.eventHandler.listen(d.querySelector(".devsite-thumb-rating-submit"),"click",async()=>{await DW(a)});return d},BW=async function(a){let b=document.body.querySelector("#devsite-thumb-thank-you-dialog");if(b)return b;const c=await _ds.y();var d=await c.isSignedIn(),e=d;d&&(e=await a.ma(),e=EW()&&!e);e&&FW(a,"Callout Profile intro");b=_ds.N(qW,{isSignedIn:d,fl:e});
document.body.appendChild(b);const f=b.querySelector(".devsite-dialog-buttons");a.mb&&(null===f||void 0===f?void 0:f.appendChild(a.mb),a.eventHandler.listen(a.mb.querySelector("button"),"click",()=>{null===b||void 0===b?void 0:b.removeAttribute("open")}));e&&f&&a.eventHandler.listen(f.querySelector(".create-profile"),"click",async()=>{null===b||void 0===b?void 0:b.removeAttribute("open");a.j=await GW(a);a.j.setAttribute("open","")});!d&&f&&(d=b.querySelector(".sign-in-button"))&&a.eventHandler.listen(d,
"click",async g=>{g.preventDefault();g.stopPropagation();g=new _ds.yi(_ds.F().href);g.h.add("thumb",a.h);_ds.Yi(g.toString(),!0,!1);await c.signIn()});return b},CW=async function(a){let b=null;"down"===a.h?b={category:"Site-Wide Custom Events",action:"devsite-rating thumb",label:"Thumb Down Rating",value:-1}:"up"===a.h&&(b={category:"Site-Wide Custom Events",action:"devsite-rating thumb",label:"Thumb Up Rating",value:1});a.dispatchEvent(new CustomEvent("devsite-analytics-observation",{detail:b,bubbles:!0}))},
uW=async function(a){var b;let c="RATING_STATE_UNKNOWN";"down"===a.h?c="THUMBS_DOWN":"up"===a.h&&(c="THUMBS_UP");var d=await a.ma();if(null!==d&&void 0!==d&&d.profileId){var e=_ds.F().href;try{e=await _ds.Wn(e)}catch(g){}var f=new _ds.OA;try{await f.Te({path:e,status:c,profileId:null===d||void 0===d?void 0:d.profileId})}catch(g){null===(b=a.j)||void 0===b?void 0:b.removeAttribute("open");a.v=HW(a,"\u5132\u5b58\u7db2\u9801\u8a55\u5206\u6642\u767c\u751f\u554f\u984c\u3002");a.v.setAttribute("open","");
return}a.h&&(a=document.querySelector("devsite-user#devsite-user"),d=await _ds.Pn("/saved-pages",null===d||void 0===d?void 0:d.profileId,null===d||void 0===d?void 0:d.vanityId),await (null===a||void 0===a?void 0:a.Id("view-rated-pages",d)))}},DW=async function(a){var b,c,d,e,f,g,h,k,l,m;if("down"===a.h){var n=(null===(c=null===(b=a.D)||void 0===b?void 0:b.querySelector("input[type=radio]:checked"))||void 0===c?void 0:c.id)||"";IW(a,n);null===(d=a.mb)||void 0===d?void 0:d.setAttribute("rating-type",
"thumbsDown");null===(e=a.mb)||void 0===e?void 0:e.setAttribute("rating-category",n);null===(f=a.D)||void 0===f?void 0:f.removeAttribute("open")}else"up"===a.h&&(n=(null===(h=null===(g=a.F)||void 0===g?void 0:g.querySelector("input[type=radio]:checked"))||void 0===h?void 0:h.id)||"",IW(a,n),null===(k=a.mb)||void 0===k?void 0:k.setAttribute("rating-type","thumbsUp"),null===(l=a.mb)||void 0===l?void 0:l.setAttribute("rating-category",n),null===(m=a.F)||void 0===m?void 0:m.removeAttribute("open"));a.C=
await BW(a);a.C.setAttribute("open","")},FW=function(a,b,c){let d=null;"down"===a.h?d={category:"Site-Wide Custom Events",action:b,label:"Rating Widget Callout",value:-1}:"up"===a.h&&(d={category:"Site-Wide Custom Events",action:b,label:"Rating Widget Callout",value:1});c=c||{};b=Object.assign(Object.assign({Va:"Site-Wide Custom Events",action:b},d),c);a.dispatchEvent(new CustomEvent("devsite-analytics-observation",{detail:b,bubbles:!0}))},GW=async function(a){var b=await a.ub();FW(a,"Callout Profile displayed");
var c=document.body.querySelector("#devsite-thumb-create-profile-dialog");if(c)return c;c=(await _ds.Nn()).href;c=_ds.N(sW,{Hb:c,ub:b});document.body.appendChild(c);if(b=c.querySelector(".devsite-dialog-buttons")){var d=b.querySelector(".create-profile");d&&a.eventHandler.listen(d,"click",()=>{a.createProfile()});(d=b.querySelector(".change-account-button"))&&a.eventHandler.listen(d,"click",async e=>{e.preventDefault();e.stopPropagation();e=new _ds.yi(_ds.F().href);e.h.add("thumb",a.h);_ds.Yi(e.toString(),
!0,!1);await (await _ds.y()).changeAccount()});a.eventHandler.listen(b.querySelector(".devsite-dialog-close"),"click",()=>{FW(a,"Callout Profile dismissed")})}return c},EW=function(){const a=document.querySelector("devsite-user#devsite-user");return null!=a&&a.hasAttribute("enable-profiles")},HW=function(a,b){FW(a,"Callout Profile error",{label:"Rating Widget Callout Error"});if(a=document.body.querySelector("#devsite-thumb-error-dialog"))return a;a=_ds.N(tW,{error:b});document.body.appendChild(a);
return a},IW=function(a,b){let c=null;"down"===a.h?c={category:"Site-Wide Custom Events",action:"devsite-rating category",label:`Rating Category: ${b}`,value:-1}:"up"===a.h&&(c={category:"Site-Wide Custom Events",action:"devsite-rating category",label:`Rating Category: ${b}`,value:1});a.dispatchEvent(new CustomEvent("devsite-analytics-observation",{detail:c,bubbles:!0}))},JW=class extends _ds.D{constructor(){super(["devsite-snackbar","devsite-dialog","devsite-feedback"]);this.eventHandler=new _ds.I;
this.C=this.v=this.j=this.mb=null;this.H=[];this.D=null;this.G=[];this.F=null;this.h=""}static get observedAttributes(){return["rating"]}async connectedCallback(){var a,b=document.querySelector(".devsite-thumb-rating-feedback");if(b&&(this.mb=null===(a=b.content.firstElementChild)||void 0===a?void 0:a.cloneNode(!0))&&(b=this.mb.querySelector("button"),null===b||void 0===b?void 0:b.classList.add("button-with-icon"),b&&b.firstChild)){const c=_ds.N(rW);b.insertBefore(c,b.firstChild)}if((b=document.querySelector(".devsite-thumb-rating-down-categories"))&&
b.content)try{this.H=JSON.parse(b.content.textContent||"")}catch(c){this.H=[]}if((b=document.querySelector(".devsite-thumb-rating-up-categories"))&&b.content)try{this.G=JSON.parse(b.content.textContent||"")}catch(c){this.G=[]}await vW(this);wW(this);yW(this)}disconnectedCallback(){_ds.J(this.eventHandler);_ds.Th(this.D);_ds.Th(this.F);_ds.Th(this.C);_ds.Th(this.j);_ds.Th(this.v)}attributeChangedCallback(a,b,c){switch(a){case "rating":this.h=c||"",wW(this)}}async ub(){var a;if(!await (await _ds.y()).isSignedIn())return!1;
const b=new _ds.MA;let c=null;try{c=await b.Za()}catch(d){}return"ELIGIBILITY_ELIGIBLE"===(null===(a=null===c||void 0===c?void 0:c.createProfile)||void 0===a?void 0:a.status)}async ma(){if(!EW()||!await (await _ds.y()).isSignedIn()||!await this.ub())return null;const a=new _ds.SA;let b=null;try{b=await a.ma()}catch(c){}return b}async createProfile(){var a,b,c,d,e,f;const g=await _ds.rE.getName();if(g){var h=null===(b=this.j)||void 0===b?void 0:b.querySelector("#devsite-thumb-create-profile-email-opt-in");
h=!(!h||!h.checked);null===(c=this.j)||void 0===c?void 0:c.classList.add("loading");var k=new _ds.SA;try{await _ds.RA(k,g,h,!0),FW(this,"Callout Profile created"),null===(d=this.j)||void 0===d?void 0:d.removeAttribute("open"),await uW(this)}catch(l){null===(e=this.j)||void 0===e?void 0:e.removeAttribute("open"),this.v=HW(this,`${l}`),this.v.setAttribute("open","")}null===(f=this.j)||void 0===f?void 0:f.classList.remove("loading")}else null===(a=this.j)||void 0===a?void 0:a.removeAttribute("open"),
this.v=HW(this,"\u53d6\u5f97\u5e33\u6236\u8cc7\u8a0a\u6642\u767c\u751f\u554f\u984c\u3002"),this.v.setAttribute("open","")}};try{window.customElements.define("devsite-thumb-rating",JW)}catch(a){console.warn("Unrecognized DevSite custom element - DevsiteThumbRating",a)};})(_ds_www);
